<UserControl x:Class="ProjectReport.Views.GeometryView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:geometry="clr-namespace:ProjectReport.Views.Geometry"
             xmlns:converters="clr-namespace:ProjectReport.Converters"
             mc:Ignorable="d"
             d:DesignHeight="800"
             d:DesignWidth="1200"
             Loaded="GeometryView_Loaded"
             KeyDown="GeometryView_KeyDown">

    <UserControl.Resources>
        <!-- Converters -->
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>
        <converters:CollectionToVisibilityConverter x:Key="CollectionToVis"/>
        <converters:NullToVisibilityConverter x:Key="NullToVis"/>

        <!-- Tokens -->
        <SolidColorBrush x:Key="AppBg" Color="#F7F8FA"/>
        <SolidColorBrush x:Key="Surface" Color="White"/>
        <SolidColorBrush x:Key="BorderSoft" Color="#E6E8EB"/>
        <SolidColorBrush x:Key="TextMuted" Color="#6B7280"/>
        <SolidColorBrush x:Key="TextStrong" Color="#111827"/>
        <SolidColorBrush x:Key="BrandOrange" Color="#F57C1F"/>
        <SolidColorBrush x:Key="BrandOrangeHover" Color="#EF6C00"/>
        <SolidColorBrush x:Key="BrandOrangePressed" Color="#E65100"/>
        <SolidColorBrush x:Key="Danger" Color="#DC2626"/>
        <SolidColorBrush x:Key="Warn" Color="#D97706"/>
        <SolidColorBrush x:Key="Success" Color="#16A34A"/>

        <!-- Card -->
        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource Surface}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="14"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
        </Style>

        <!-- Buttons -->
        <!-- Buttons (solo UI, sin tocar lógica) -->
        <Style x:Key="BrandPrimaryButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BrandOrange}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BrandOrange}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="MinHeight" Value="40"/>
            <Setter Property="MinWidth" Value="130"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="10"
                                                ShadowDepth="2"
                                                Opacity="0.18"/>
                            </Border.Effect>
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"
                                            RecognizesAccessKey="True"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{StaticResource BrandOrangeHover}"/>
                                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BrandOrangeHover}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="{StaticResource BrandOrangePressed}"/>
                                <Setter TargetName="Bd" Property="BorderBrush" Value="{StaticResource BrandOrangePressed}"/>
                                <Setter TargetName="Bd" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.99" ScaleY="0.99"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="Bd" Property="RenderTransformOrigin" Value="0.5,0.5"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.55"/>
                                <Setter Property="Cursor" Value="Arrow"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="BrandSecondaryButton" TargetType="Button">
            <Setter Property="Background" Value="#FFF3F4F6"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="MinHeight" Value="40"/>
            <Setter Property="MinWidth" Value="120"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="10">
                            <ContentPresenter HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FFEFF2F7"/>
                                <Setter TargetName="Bd" Property="BorderBrush" Value="#FFD8DDE3"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#FFE5E7EB"/>
                                <Setter TargetName="Bd" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.99" ScaleY="0.99"/>
                                    </Setter.Value>
                                </Setter>
                                <Setter TargetName="Bd" Property="RenderTransformOrigin" Value="0.5,0.5"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.55"/>
                                <Setter Property="Cursor" Value="Arrow"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="DangerButton" TargetType="Button" BasedOn="{StaticResource BrandSecondaryButton}">
            <Setter Property="Foreground" Value="{StaticResource Danger}"/>
            <Setter Property="BorderBrush" Value="#FFF1B5B5"/>
        </Style>

        <Style x:Key="IconMiniButton" TargetType="Button" BasedOn="{StaticResource BrandSecondaryButton}">
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="MinWidth" Value="36"/>
            <Setter Property="MinHeight" Value="36"/>
            <Setter Property="FontWeight" Value="Bold"/>
        </Style>


        <!-- DataGrid baseline -->
        <Style x:Key="ModernDataGrid" TargetType="DataGrid">
            <Setter Property="Background" Value="{StaticResource Surface}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="RowBackground" Value="White"/>
            <Setter Property="AlternatingRowBackground" Value="#FFF9FAFB"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="RowHeight" Value="36"/>
            <Setter Property="ColumnHeaderHeight" Value="38"/>
            <Setter Property="SelectionUnit" Value="FullRow"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="HorizontalScrollBarVisibility" Value="Auto"/>
            <Setter Property="VerticalScrollBarVisibility" Value="Auto"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#FFF3F4F6"/>
            <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="10,8"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
        </Style>

        <Style TargetType="DataGridCell">
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="8,4"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="White"/>
        </Style>

        <Style TargetType="ComboBox">
            <Setter Property="Padding" Value="6,2"/>
        </Style>

        <!-- GroupBox -->
        <Style TargetType="GroupBox">
            <Setter Property="BorderBrush" Value="{StaticResource BorderSoft}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Background" Value="{StaticResource Surface}"/>
            <Setter Property="Padding" Value="10"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
            <Style.Triggers>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.65"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style TargetType="TabItem">
            <Setter Property="Padding" Value="14,8"/>
        </Style>
    </UserControl.Resources>

    <Grid Background="{StaticResource AppBg}">
        <TabControl SelectedIndex="{Binding SelectedTabIndex, Mode=TwoWay}">

            <!-- Wellbore Geometry -->
          
            <TabItem Header="Wellbore Geometry">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Top bar -->
                        <Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                                    <TextBlock Text="Total Wellbore MD:"
                                               Foreground="{StaticResource TextMuted}"
                                               FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalWellboreMD, StringFormat='  {0:F2} ft'}"
                                               Foreground="{StaticResource BrandOrange}"
                                               FontWeight="Bold"/>
                                    <TextBlock Text="   Tip: use '.' for decimals."
                                               Foreground="{StaticResource TextMuted}"
                                               FontSize="12"
                                               VerticalAlignment="Center"/>
                                </StackPanel>

                                <Button Grid.Column="1"
                                        Content="Add Section"
                                        Style="{StaticResource BrandPrimaryButton}"
                                        Click="AddWellboreSection_Click"/>
                            </Grid>
                        </Border>

                        <!-- Error detail -->
                        <Border Grid.Row="1"
                                Margin="0,0,0,10"
                                Background="#FFFEE2E2"
                                BorderBrush="{StaticResource Danger}"
                                BorderThickness="1"
                                CornerRadius="10"
                                Padding="12"
                                Visibility="{Binding ElementName=WellboreDataGrid, Path=SelectedItem.HasValidationError, Converter={StaticResource BoolToVis}, FallbackValue=Collapsed}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="❌" FontSize="14" Margin="0,0,8,0" Foreground="{StaticResource Danger}"/>
                                <TextBlock Text="Error in selected row:" FontWeight="Bold" Foreground="{StaticResource Danger}" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding ElementName=WellboreDataGrid, Path=SelectedItem.ValidationMessage}"
                                           Foreground="{StaticResource Danger}"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- DataGrid  -->
                        <DataGrid Grid.Row="2"
                                  x:Name="WellboreDataGrid"
                                  Style="{StaticResource ModernDataGrid}"
                                  ItemsSource="{Binding WellboreComponents}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True"
                                  SelectionMode="Single">

                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasWarnings}" Value="True">
                                            <Setter Property="Background" Value="#FFFFF7E6"/>
                                            <Setter Property="BorderBrush" Value="#FFF59E0B"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding HasValidationError}" Value="True">
                                            <Setter Property="Background" Value="#FFFFF1F2"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>

                            <DataGrid.Columns>
                                <!-- 0. Status -->
                                <DataGridTemplateColumn Header="" Width="34">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <TextBlock Text="⚠️"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           ToolTip="{Binding WarningMessage}"
                                                           Visibility="{Binding HasWarnings, Converter={StaticResource BoolToVis}}"/>
                                                <TextBlock Text="!"
                                                           Foreground="{StaticResource Danger}"
                                                           FontWeight="Bold"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"
                                                           ToolTip="{Binding ValidationMessage}"
                                                           Visibility="{Binding HasValidationError, Converter={StaticResource BoolToVis}}"/>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <!-- 1. ID -->
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60" IsReadOnly="True"/>

                                <!-- 2. Section Type -->
                                <DataGridTemplateColumn Header="Section Type" Width="160">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding SectionType}" VerticalAlignment="Center" Padding="10,6"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.WellboreSectionTypes, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                      SelectedItem="{Binding SectionType, UpdateSourceTrigger=PropertyChanged}"
                                                      DisplayMemberPath="."/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <!-- 3. OD -->
                                <DataGridTemplateColumn Width="110">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="OD (in)" ToolTip="For OpenHole: Hole diameter. For Casing/Liner: Outer diameter."/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding OD, StringFormat=F3, TargetNullValue=''}" VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding HasWarnings}" Value="True">
                                                                <Setter Property="Foreground" Value="{StaticResource Warn}"/>
                                                                <Setter Property="ToolTip" Value="{Binding WarningMessage}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Foreground" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding OD, StringFormat=F3, TargetNullValue='', UpdateSourceTrigger=PropertyChanged}">
                                                <TextBox.Style>
                                                    <Style TargetType="TextBox">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Background" Value="#FFFFF1F2"/>
                                                                <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBox.Style>
                                            </TextBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <!-- 4. ID -->
                                <DataGridTemplateColumn Width="110">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="ID (in)" ToolTip="For OpenHole: always 0.000. For Casing/Liner: Inner diameter."/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ID, StringFormat=F3, TargetNullValue=''}" VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SectionType}" Value="OpenHole">
                                                                <Setter Property="Foreground" Value="{StaticResource TextMuted}"/>
                                                                <Setter Property="FontStyle" Value="Italic"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Foreground" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding ID, StringFormat=F3, TargetNullValue='', UpdateSourceTrigger=PropertyChanged}">
                                                <TextBox.Style>
                                                    <Style TargetType="TextBox">
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SectionType}" Value="OpenHole">
                                                                <Setter Property="IsEnabled" Value="False"/>
                                                                <Setter Property="Background" Value="#FFF3F4F6"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Background" Value="#FFFFF1F2"/>
                                                                <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBox.Style>
                                            </TextBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <!-- 5. Top MD -->
                                <DataGridTextColumn Header="Top MD (ft)" Binding="{Binding TopMD, StringFormat=F2, TargetNullValue=''}" Width="130"/>

                                <!-- 6. Bottom MD -->
                                <DataGridTextColumn Header="Bottom MD (ft)" Binding="{Binding BottomMD, StringFormat=F2, TargetNullValue=''}" Width="140"/>

                                <!-- 7. Washout -->
                                <DataGridTemplateColumn Width="130">
                                    <DataGridTemplateColumn.Header>
                                        <TextBlock Text="Washout (%)" ToolTip="Only for OpenHole. Typical 5–25%. Min 0.01%."/>
                                    </DataGridTemplateColumn.Header>
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock VerticalAlignment="Center">
                                                <TextBlock.Style>
                                                    <Style TargetType="TextBlock">
                                                        <Setter Property="Text" Value="N/A"/>
                                                        <Setter Property="Foreground" Value="{StaticResource TextMuted}"/>
                                                        <Setter Property="FontStyle" Value="Italic"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SectionType}" Value="OpenHole">
                                                                <Setter Property="Text" Value="{Binding Washout, StringFormat=F2}"/>
                                                                <Setter Property="Foreground" Value="{StaticResource TextStrong}"/>
                                                                <Setter Property="FontStyle" Value="Normal"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasWarnings}" Value="True">
                                                                <Setter Property="Foreground" Value="{StaticResource Warn}"/>
                                                                <Setter Property="ToolTip" Value="{Binding WarningMessage}"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Foreground" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBlock.Style>
                                            </TextBlock>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <TextBox Text="{Binding Washout, StringFormat=F2, TargetNullValue='', UpdateSourceTrigger=PropertyChanged}">
                                                <TextBox.Style>
                                                    <Style TargetType="TextBox">
                                                        <Setter Property="IsEnabled" Value="False"/>
                                                        <Style.Triggers>
                                                            <DataTrigger Binding="{Binding SectionType}" Value="OpenHole">
                                                                <Setter Property="IsEnabled" Value="True"/>
                                                            </DataTrigger>
                                                            <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                                                <Setter Property="Background" Value="#FFFFF1F2"/>
                                                                <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                                                <Setter Property="ToolTip" Value="{Binding ValidationMessage}"/>
                                                            </DataTrigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </TextBox.Style>
                                            </TextBox>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <!-- 8. Volume -->
                                <DataGridTextColumn Header="Volume (bbl)" Binding="{Binding Volume, StringFormat=F2}" Width="130" IsReadOnly="True"/>

                                <!-- 9. Actions -->
                                <DataGridTemplateColumn Header="Actions" Width="160">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="↑" Style="{StaticResource IconMiniButton}" ToolTip="Move Up"
                                                        Click="MoveWellboreUp_Click" Tag="{Binding}"/>
                                                <Button Content="↓" Style="{StaticResource IconMiniButton}" ToolTip="Move Down"
                                                        Click="MoveWellboreDown_Click" Tag="{Binding}"/>
                                                <Button Content="×" Style="{StaticResource IconMiniButton}" ToolTip="Delete"
                                                        Click="DeleteWellbore_Click" Tag="{Binding}" Foreground="{StaticResource Danger}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- ========================= -->
            <!-- Drill String Geometry -->
            <!-- ========================= -->
            <TabItem Header="Drill String Geometry">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Drill String Top barra -->
                        <Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <Grid VerticalAlignment="Center">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <!-- MÉTRICAS -->
                                <WrapPanel Grid.Column="0"
                                        VerticalAlignment="Center"
                                        ItemHeight="26">

                                    <TextBlock Text="Total Drill String MD:"
                                            Foreground="{StaticResource TextMuted}"
                                            FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalDrillStringLength, StringFormat='  {0:F2} ft'}"
                                            Foreground="{StaticResource BrandOrange}"
                                            FontWeight="Bold"
                                            Margin="4,0,16,0"/>

                                    <TextBlock Text="Depth to Bottom:"
                                            Foreground="{StaticResource TextMuted}"
                                            FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding DepthDifferential, StringFormat='  {0:+0.00;-0.00;0.00} ft'}"
                                            FontWeight="Bold"
                                            Foreground="{Binding DepthDifferentialColor}"
                                            Margin="4,0,16,0"/>

                                    <TextBlock FontWeight="SemiBold"
                                            Foreground="{StaticResource Success}"
                                            Margin="0,0,16,0"
                                            Visibility="{Binding DepthDifferentialStatus, Converter={StaticResource NullToVis}}"
                                            Text="{Binding DepthDifferentialStatus}"/>

                                    <TextBlock Text="Total Wellbore MD:"
                                            Foreground="{StaticResource TextMuted}"
                                            FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalWellboreMD, StringFormat='  {0:F2} ft'}"
                                            Foreground="{StaticResource BrandOrange}"
                                            FontWeight="Bold"/>
                                </WrapPanel>

                                <!-- ACCIONES -->
                                <StackPanel Grid.Column="1"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center">

                                    <Button Content="Ajustar MD al Fondo"
                                            Style="{StaticResource BrandPrimaryButton}"
                                            Command="{Binding ForceToBottomCommand}"
                                            IsEnabled="{Binding CanForceToBottom}"
                                            Margin="0,0,10,0"/>

                                    <Button Content="Add Component"
                                            Style="{StaticResource BrandPrimaryButton}"
                                            MinWidth="140"
                                            Click="AddDrillStringComponent_Click"/>
                                </StackPanel>
                            </Grid>
                        </Border>


                        <!-- Error detail -->
                        <Border Grid.Row="1"
                                Margin="0,0,0,10"
                                Background="#FFFEE2E2"
                                BorderBrush="{StaticResource Danger}"
                                BorderThickness="1"
                                CornerRadius="10"
                                Padding="12"
                                Visibility="{Binding ElementName=DrillStringDataGrid, Path=SelectedItem.HasValidationError, Converter={StaticResource BoolToVis}, FallbackValue=Collapsed}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="❌" FontSize="14" Margin="0,0,8,0" Foreground="{StaticResource Danger}"/>
                                <TextBlock Text="Error in selected row:" FontWeight="Bold" Foreground="{StaticResource Danger}" Margin="0,0,6,0"/>
                                <TextBlock Text="{Binding ElementName=DrillStringDataGrid, Path=SelectedItem.ValidationMessage}"
                                           Foreground="{StaticResource Danger}" TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <!-- DataGrid -->
                        <DataGrid Grid.Row="2"
                                  x:Name="DrillStringDataGrid"
                                  Style="{StaticResource ModernDataGrid}"
                                  ItemsSource="{Binding DrillStringComponents}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True"
                                  SelectionMode="Single"
                                  CanUserReorderColumns="False"
                                  AllowDrop="True"
                                  Drop="DrillStringDataGrid_Drop"
                                  PreviewMouseLeftButtonDown="DrillStringDataGrid_PreviewMouseLeftButtonDown"
                                  PreviewMouseMove="DrillStringDataGrid_PreviewMouseMove">

                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasValidationError}" Value="True">
                                            <Setter Property="Background" Value="#FFFFF1F2"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding IsHighlighted}" Value="True">
                                            <Setter Property="Background" Value="#FFEAFBF0"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource Success}"/>
                                            <Setter Property="BorderThickness" Value="2"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>

                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="" Width="34">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="❌"
                                                       Foreground="{StaticResource Danger}"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       ToolTip="{Binding ValidationMessage}"
                                                       Visibility="{Binding HasValidationError, Converter={StaticResource BoolToVis}}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Name" Binding="{Binding Name, UpdateSourceTrigger=PropertyChanged}" Width="160"/>

                                <DataGridTemplateColumn Header="Type" Width="160">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding ComponentType}" VerticalAlignment="Center" Padding="10,6"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.ComponentTypes, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                      SelectedItem="{Binding ComponentType, UpdateSourceTrigger=PropertyChanged}"
                                                      DisplayMemberPath="."/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="Length (ft)" Binding="{Binding Length, StringFormat=F2}" Width="130"/>
                                <DataGridTextColumn Header="OD (in)" Binding="{Binding OD, StringFormat=F3, UpdateSourceTrigger=PropertyChanged}" Width="110"/>
                                <DataGridTextColumn Header="ID (in)" Binding="{Binding ID, StringFormat=F3, UpdateSourceTrigger=PropertyChanged}" Width="110"/>
                                <DataGridTextColumn Header="Volume (bbl)" Binding="{Binding InternalVolume, StringFormat=F2}" Width="130" IsReadOnly="True"/>

                                <DataGridTemplateColumn Header="Actions" Width="240">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="Config" Style="{StaticResource BrandSecondaryButton}"
                                                        Padding="12,4" Margin="0,0,6,0"
                                                        ToolTip="Configure Component"
                                                        Click="ConfigureComponent_Click"
                                                        Tag="{Binding}"/>
                                                <Button Content="↑" Style="{StaticResource IconMiniButton}" ToolTip="Move Up"
                                                        Click="MoveDrillStringUp_Click" Tag="{Binding}"/>
                                                <Button Content="↓" Style="{StaticResource IconMiniButton}" ToolTip="Move Down"
                                                        Click="MoveDrillStringDown_Click" Tag="{Binding}"/>
                                                <Button Content="×" Style="{StaticResource IconMiniButton}" ToolTip="Delete"
                                                        Click="DeleteDrillString_Click" Tag="{Binding}" Foreground="{StaticResource Danger}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- ========================= -->
            <!-- Survey -->
            <!-- ========================= -->
            <TabItem Header="Survey">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Grid.Column="0"
                                           Text="Survey points define the trajectory. Keep MD increasing."
                                           Foreground="{StaticResource TextMuted}"
                                           VerticalAlignment="Center"/>

                                <Button Grid.Column="1"
                                        Content="Load from Excel"
                                        Style="{StaticResource BrandSecondaryButton}"
                                        Margin="0,0,10,0"
                                        Click="LoadSurveyFromExcel_Click"/>

                                <Button Grid.Column="2"
                                        Content="Add Survey Point"
                                        Style="{StaticResource BrandPrimaryButton}"
                                        Click="AddSurveyPoint_Click"/>
                            </Grid>
                        </Border>

                        <DataGrid Grid.Row="1"
                                  x:Name="SurveyDataGrid"
                                  Style="{StaticResource ModernDataGrid}"
                                  ItemsSource="{Binding SurveyPoints}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True"
                                  SelectionMode="Single">

                            <DataGrid.RowStyle>
                                <Style TargetType="DataGridRow">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding HasErrors}" Value="True">
                                            <Setter Property="Background" Value="#FFFFF1F2"/>
                                            <Setter Property="BorderBrush" Value="{StaticResource Danger}"/>
                                            <Setter Property="BorderThickness" Value="1"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.RowStyle>

                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="" Width="34">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="!"
                                                       Foreground="{StaticResource Danger}"
                                                       FontWeight="Bold"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       ToolTip="{Binding ValidationMessage}"
                                                       Visibility="{Binding HasErrors, Converter={StaticResource BoolToVis}}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60" IsReadOnly="True"/>

                                <DataGridTextColumn Header="MD (ft)" Binding="{Binding MD, StringFormat=F2}" Width="130"/>
                                <DataGridTextColumn Header="TVD (ft)" Binding="{Binding TVD, StringFormat=F2}" Width="130"/>
                                <DataGridTextColumn Header="Hole Angle (deg)" Binding="{Binding HoleAngle, StringFormat=F2}" Width="160"/>
                                <DataGridTextColumn Header="Azimuth (deg)" Binding="{Binding Azimuth, StringFormat=F2}" Width="140"/>
                                <DataGridTextColumn Header="Horizontal Displacement (ft)" Binding="{Binding Northing, StringFormat=F2}" Width="220"/>

                                <DataGridTemplateColumn Header="Actions" Width="160">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="↑" Style="{StaticResource IconMiniButton}" ToolTip="Move Up"
                                                        Click="MoveSurveyUp_Click" Tag="{Binding}"/>
                                                <Button Content="↓" Style="{StaticResource IconMiniButton}" ToolTip="Move Down"
                                                        Click="MoveSurveyDown_Click" Tag="{Binding}"/>
                                                <Button Content="×" Style="{StaticResource IconMiniButton}" ToolTip="Delete"
                                                        Click="DeleteSurvey_Click" Tag="{Binding}" Foreground="{StaticResource Danger}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- ========================= -->
            <!-- Thermal Gradient -->
            <!-- ========================= -->
            <TabItem Header="Thermal Gradient">
                <Grid Margin="18">
                    <Border Style="{StaticResource CardBorder}">
                        <geometry:ThermalGradientView DataContext="{Binding ThermalGradientViewModel}"/>
                    </Border>
                </Grid>
            </TabItem>

            <!-- ========================= -->
            <!-- Well Test -->
            <!-- ========================= -->
            <TabItem Header="Well Test">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0" Style="{StaticResource CardBorder}" Margin="0,0,0,12">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <TextBlock Text="Keep tests aligned to a section."
                                           Foreground="{StaticResource TextMuted}"
                                           VerticalAlignment="Center"/>

                                <Button Grid.Column="1"
                                        Content="Add Well Test"
                                        Style="{StaticResource BrandPrimaryButton}"
                                        Click="AddWellTest_Click"/>
                            </Grid>
                        </Border>

                        <DataGrid Grid.Row="1"
                                  x:Name="WellTestDataGrid"
                                  Style="{StaticResource ModernDataGrid}"
                                  ItemsSource="{Binding WellTests}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  CanUserDeleteRows="True"
                                  SelectionMode="Single">

                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60" IsReadOnly="True"/>

                                <DataGridTemplateColumn Header="Section" Width="180">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding Section}" VerticalAlignment="Center"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.WellboreSectionNames, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                      SelectedItem="{Binding Section, UpdateSourceTrigger=PropertyChanged}"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTemplateColumn Header="Dropdown Test Type" Width="220">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding TypeString}" VerticalAlignment="Center" Padding="10,6"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                    <DataGridTemplateColumn.CellEditingTemplate>
                                        <DataTemplate>
                                            <ComboBox ItemsSource="{Binding DataContext.WellTestTypes, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                                      SelectedItem="{Binding TypeString, UpdateSourceTrigger=PropertyChanged}"
                                                      DisplayMemberPath="."/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellEditingTemplate>
                                </DataGridTemplateColumn>

                                <DataGridTextColumn Header="Test Value (ppb)" Binding="{Binding TestValue, StringFormat=F2}" Width="160"/>

                                <DataGridTemplateColumn Header="Actions" Width="160">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                                                <Button Content="↑" Style="{StaticResource IconMiniButton}" ToolTip="Move Up"
                                                        Click="MoveWellTestUp_Click" Tag="{Binding}"/>
                                                <Button Content="↓" Style="{StaticResource IconMiniButton}" ToolTip="Move Down"
                                                        Click="MoveWellTestDown_Click" Tag="{Binding}"/>
                                                <Button Content="×" Style="{StaticResource IconMiniButton}" ToolTip="Delete"
                                                        Click="DeleteWellTest_Click" Tag="{Binding}" Foreground="{StaticResource Danger}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>

                    </Grid>
                </ScrollViewer>
            </TabItem>

            <!-- ========================= -->
            <!-- Summary (incluye VisualSchemeCanvas) -->
            <!-- ========================= -->
            <TabItem Header="Summary">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <Grid Margin="18">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <GroupBox Grid.Row="0" Header="Volume Summary">
                            <Grid Margin="10">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0" Margin="10">
                                    <TextBlock Text="Total Wellbore Volume" Foreground="{StaticResource TextMuted}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalWellboreVolume, StringFormat='{}{0:F2} bbl'}"
                                               FontSize="22" FontWeight="Bold" Foreground="{StaticResource BrandOrange}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="1" Margin="10">
                                    <TextBlock Text="Total Drill String Volume" Foreground="{StaticResource TextMuted}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalDrillStringVolume, StringFormat='{}{0:F2} bbl'}"
                                               FontSize="22" FontWeight="Bold" Foreground="{StaticResource BrandOrange}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="2" Margin="10">
                                    <TextBlock Text="Total Annular Volume" Foreground="{StaticResource TextMuted}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalAnnularVolume, StringFormat='{}{0:F2} bbl'}"
                                               FontSize="22" FontWeight="Bold" Foreground="{StaticResource BrandOrange}"/>
                                </StackPanel>

                                <StackPanel Grid.Column="3" Margin="10">
                                    <TextBlock Text="Total Circulation Volume" Foreground="{StaticResource TextMuted}" FontWeight="SemiBold"/>
                                    <TextBlock Text="{Binding TotalCirculationVolume, StringFormat='{}{0:F2} bbl'}"
                                               FontSize="22" FontWeight="Bold" Foreground="{StaticResource BrandOrange}"/>
                                </StackPanel>
                            </Grid>
                        </GroupBox>

                        <GroupBox Grid.Row="1" Header="Annular Volume Details">
                            <DataGrid ItemsSource="{Binding AnnularVolumeDetails}"
                                      Style="{StaticResource ModernDataGrid}"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      IsReadOnly="True"
                                      MaxHeight="280"
                                      Margin="10">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                                    <DataGridTextColumn Header="Section/Component Name" Binding="{Binding Name}" Width="220"/>
                                    <DataGridTextColumn Header="Wellbore ID (in)" Binding="{Binding WellboreID, StringFormat=F3}" Width="140"/>
                                    <DataGridTextColumn Header="Drill String OD (in)" Binding="{Binding DrillStringOD, StringFormat=F3}" Width="160"/>
                                    <DataGridTextColumn Header="Depth Range (ft)" Binding="{Binding DepthRange}" Width="160"/>
                                    <DataGridTextColumn Header="Annular Volume (bbl)" Binding="{Binding Volume, StringFormat=F2}" Width="170"/>
                                </DataGrid.Columns>
                            </DataGrid>
                        </GroupBox>

                        <GroupBox Grid.Row="2" Header="Visual Scheme">
                            <Border Height="320" Background="#FFF3F4F6" CornerRadius="10" Margin="10">
                              
                                <Canvas x:Name="VisualSchemeCanvas" Background="Transparent">
                                    <TextBlock Text="Visual representation of wellbore and drill string geometry"
                                               Foreground="{StaticResource TextMuted}"
                                               TextAlignment="Center"
                                               TextWrapping="Wrap"
                                               Canvas.Left="50"
                                               Canvas.Top="150"/>
                                </Canvas>
                            </Border>
                        </GroupBox>

                    </Grid>
                </ScrollViewer>
            </TabItem>

        </TabControl>
    </Grid>
</UserControl>
